// Generated by CoffeeScript 1.8.0
var DETAILS_FORM, EVENTS, TIME_FORM, closeModalListener, dayListener, detailsCTAListener, finaliseBookingListener, hideHour, hideMinute, hourPopoverListener, minutePopoverListener, popoverListener, responsiveCal, timeInputListener, timeListbuilder, timeListener, toggleModal;

TIME_FORM = '#time-form';

DETAILS_FORM = '#details-form';

EVENTS = {
  '2014-10-31': {
    'number': 5
  },
  '2014-10-20': {
    'number': 3
  },
  '2014-10-15': {
    'number': 9
  }
};

responsiveCal = function() {
  return $('.responsive-calendar').responsiveCalendar({
    time: '2014-10',
    events: EVENTS
  });
};

dayListener = function() {
  return $('.day').on('click', function(event) {
    var $target, day, month, year;
    event.preventDefault();
    $target = $(event.target);
    day = $target.data('day');
    month = $target.data('month');
    year = $target.data('year');
    $('#full-date').text("" + day + "-" + month + "-" + year);
    return toggleModal(TIME_FORM);
  });
};

closeModalListener = function() {
  return $(".close-modal").on("click", function(event) {
    var target;
    event.preventDefault();
    target = $(event.target);
    return toggleModal(TIME_FORM);
  });
};

timeListener = function() {
  $('.hour').on('click', function(event) {
    event.preventDefault();
    return hideMinute();
  });
  return $('.minute').on('click', function(event) {
    event.preventDefault();
    return hideHour();
  });
};

hideMinute = function() {
  return $('.minute').popover('hide');
};

hideHour = function() {
  return $('.hour').popover('hide');
};

timeListbuilder = function(times) {
  var listArray;
  listArray = _.collect(times, function(time) {
    return "<li class='time-input' data-value='" + time + "'><a class='time-link' href='#'>" + time + " <span class='badge'>2</a></a></li>";
  });
  return listArray.join('');
};

popoverListener = function(times, type) {
  return $("." + type).popover({
    'title': "Select booking " + type,
    'html': 'true',
    'placement': 'bottom',
    'content': "<ul> " + (timeListbuilder(times)) + " </ul>"
  });
};

minutePopoverListener = function() {
  var minutes;
  minutes = _.range(0, 60, 15);
  popoverListener(minutes, 'minute');
  return timeInputListener();
};

hourPopoverListener = function() {
  var hours;
  hours = _.range(9, 18);
  popoverListener(hours, 'hour');
  return timeInputListener();
};

timeInputListener = function() {
  return $('.time-link').on('click', function(event) {
    var $target;
    alert('click!');
    event.preventDefault();
    return $target = $(event.target);
  });
};

detailsCTAListener = function() {
  return $('.details').on('click', function(event) {
    var $target;
    event.preventDefault();
    $target = $(event.target);
    return toggleModal(DETAILS_FORM);
  });
};

finaliseBookingListener = function() {
  return $('.finalise-booking').on('click', function(event) {
    var $target;
    event.preventDefault();
    $target = $(event.target);
    return $("#finalise-booking").toggleClass('hidden');
  });
};

toggleModal = function(id) {
  return $(id).toggleClass('hidden');
};

$(document).ready(function() {
  responsiveCal();
  window.setTimeout(dayListener, 1000);
  closeModalListener();
  hourPopoverListener();
  minutePopoverListener();
  timeListener();
  detailsCTAListener();
  return finaliseBookingListener();
});
